<!doctype html>
<html lang="tr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RÃ¼yanÄ± GÃ¶nder â€¢ DreamOracle</title>
  <meta name="description" content="RÃ¼yanÄ± yaz, 24 saat iÃ§inde e-postana yorum gelsin. Premium paketle koÃ§luk ve aksiyon listesi.">
  <link rel="icon" href="/favicon.svg" />
  <style>
    :root{
      --bg:#0b1424;--card:#0f1a2f;--muted:#8ea6c0;--accent:#4cc3ff;--accent2:#00d1ff;--ok:#18c37e;--warn:#ffc23d;--err:#ff6b6b;
    }
    *{box-sizing:border-box}
    html,body{margin:0;padding:0;background:var(--bg);color:#e8f1ff;font:16px/1.6 Inter,system-ui,sans-serif}
    a{color:#e8f1ff;text-decoration:none}
    .wrap{max-width:1000px;margin:32px auto;padding:0 20px}
    .nav{display:flex;gap:16px;align-items:center;justify-content:space-between;margin-bottom:16px}
    .brand{display:flex;align-items:center;gap:10px;font-weight:700}
    .brand-badge{width:28px;height:28px;border-radius:8px;background:linear-gradient(135deg,var(--accent),var(--accent2));display:grid;place-items:center;color:#001229;font-weight:900}
    .card{background:var(--card);border:1px solid #29486d;border-radius:16px;padding:22px}
    .grid{display:grid;grid-template-columns:1fr 360px;gap:22px}
    @media (max-width: 980px){.grid{grid-template-columns:1fr}}
    label{display:block;margin:10px 0 6px;color:#b9cee4;font-weight:600}
    input,select,textarea{
      width:100%;padding:12px 14px;border-radius:10px;border:1px solid #29486d;background:#0c162b;color:#e8f1ff
    }
    textarea{min-height:160px;resize:vertical}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    .btn{display:inline-flex;align-items:center;justify-content:center;padding:12px 18px;border-radius:12px;border:1px solid #2b7bbd;background:linear-gradient(180deg,#109be0,#0f7ac1);color:#fff;cursor:pointer}
    .btn:hover{filter:brightness(1.07)}
    .muted{color:var(--muted)}
    .caps{font-size:12px;text-transform:uppercase;letter-spacing:.08em;color:#9bb7d6}
    .hint{font-size:14px;color:#b9cee4}
    .callout{border:1px solid #2a4060;border-radius:12px;padding:12px 14px;margin-top:14px}
    .callout.ok{background:#0e2a22;border-color:#12624a;color:#a8f4d7}
    .callout.err{background:#2a1212;border-color:#7a2b2b;color:#ffb0b0}
    .badges{display:flex;gap:8px;flex-wrap:wrap;margin:6px 0 0}
    .badge{font-size:12px;border:1px solid #2a4060;border-radius:999px;padding:4px 10px;color:#c9dbef;background:#0d1930}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="nav">
      <div class="brand">
        <div class="brand-badge">D</div> DreamOracle
      </div>
      <div style="display:flex;gap:14px;">
        <a href="/">Anasayfa</a>
        <a href="/premium.html">Premium</a>
      </div>
    </div>

    <div class="grid">
      <div class="card">
        <h1 style="margin:0 0 6px">RÃ¼yanÄ± GÃ¶nder</h1>
        <p class="muted" style="margin-top:0">Formu doldur, 24 saat iÃ§inde e-postana yanÄ±t gelsin. EÄŸer bu sayfaya bir butondan geldiysen <span class="caps">paket</span> ve <span class="caps">kategori</span> alanlarÄ± senin iÃ§in otomatik seÃ§ilir.</p>

        <div id="chips" class="badges" style="display:none"></div>

        <form id="dreamForm" style="margin-top:12px">
          <label for="c-name">Ad Soyad</label>
          <input id="c-name" name="name" placeholder="AdÄ±n SoyadÄ±n" required />

          <div class="row">
            <div>
              <label for="c-email">E-posta</label>
              <input id="c-email" name="email" type="email" placeholder="ornek@mail.com" required />
            </div>
            <div>
              <label for="c-priority">Ã–ncelik</label>
              <select id="c-priority" name="priority">
                <option value="genel">Genel yorum</option>
                <option value="iÅŸ">Ä°ÅŸ / para</option>
                <option value="iliÅŸki">Ä°liÅŸki</option>
                <option value="saÄŸlÄ±k">SaÄŸlÄ±k</option>
              </select>
            </div>
          </div>

          <div class="row">
            <div>
              <label for="c-paket">Paket</label>
              <select id="c-paket" name="paket">
                <option value="standart">Standart (Ãœcretsiz)</option>
                <option value="premium">Premium + KoÃ§luk</option>
              </select>
            </div>
            <div>
              <label for="c-kategori">Kategori</label>
              <select id="c-kategori" name="kategori">
                <option value="ruya">RÃ¼ya</option>
                <option value="tarot">Tarot</option>
                <option value="kahve">Kahve</option>
                <option value="yildiz">YÄ±ldÄ±z</option>
                <option value="coach">YaÅŸam KoÃ§luÄŸu</option>
              </select>
            </div>
          </div>

          <label for="c-msg">RÃ¼yanÄ±z</label>
          <textarea id="c-msg" name="message" placeholder="RÃ¼yanÄ± olabildiÄŸince detaylÄ± yaz. Yer, kiÅŸiler, hissettiklerin, tekrar eden sembollerâ€¦"></textarea>

          <div style="display:flex;gap:10px;align-items:center;margin-top:12px">
            <button class="btn" type="submit">GÃ¶nder â†’</button>
            <div id="state" class="muted"></div>
          </div>

          <div id="alert" class="callout err" style="display:none"></div>
          <div id="success" class="callout ok" style="display:none"></div>
        </form>
      </div>

      <aside class="card">
        <div class="caps">Ä°puÃ§larÄ±</div>
        <p class="hint">Tekrarlayan semboller, gÃ¼Ã§lÃ¼ duygular ve â€œuyandÄ±ktan sonra aklÄ±nda kalanâ€ sahneler Ã§ok yardÄ±mcÄ± olur. 3â€“5 maddelik kÃ¼Ã§Ã¼k aksiyon listesi Ã§Ä±kar; Standartta 24 saat iÃ§inde e-posta alÄ±rsÄ±n.</p>
        <hr style="border:0;border-top:1px solid #243a58;margin:16px 0">
        <div class="caps">Gizlilik</div>
        <p class="hint">Verilerini yalnÄ±zca yorum/koÃ§luk oluÅŸturmak iÃ§in kullanÄ±rÄ±z. KayÄ±t tutmayÄ±z.</p>
      </aside>
    </div>
  </div>

  <script>
    // --- yardÄ±mcÄ±lar ---
    const qs = new URLSearchParams(location.search);
    const byId = (id) => document.getElementById(id);

    // Query param -> form Ã¶n seÃ§im + etiketler
    const paket = qs.get('paket');      // standart | premium
    const kategori = qs.get('kategori');// ruya | tarot | kahve | yildiz | coach
    const oncelik = qs.get('oncelik');  // genel | iÅŸ | iliÅŸki | saÄŸlÄ±k

    if (paket) byId('c-paket').value = paket;
    if (kategori) byId('c-kategori').value = kategori;
    if (oncelik) byId('c-priority').value = oncelik;

    // SeÃ§imler varsa Ã¼stte chip gÃ¶ster
    const chips = [];
    if (paket)    chips.push(`Paket: ${paket}`);
    if (kategori) chips.push(`Kategori: ${kategori}`);
    if (oncelik)  chips.push(`Ã–ncelik: ${oncelik}`);
    if (chips.length) {
      const box = byId('chips');
      box.style.display = 'flex';
      box.innerHTML = chips.map(t => `<span class="badge">${t}</span>`).join('');
    }

    // Form submit
    const form = byId('dreamForm');
    const stateEl = byId('state');
    const alertEl = byId('alert');
    const okEl = byId('success');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      alertEl.style.display = 'none';
      okEl.style.display = 'none';
      stateEl.textContent = 'GÃ¶nderiliyorâ€¦';

      const payload = {
        name: byId('c-name').value.trim(),
        email: byId('c-email').value.trim(),
        message: byId('c-msg').value.trim(),
        paket: byId('c-paket').value,
        kategori: byId('c-kategori').value,
        priority: byId('c-priority').value
      };

      try {
        const r = await fetch('/api/send-email', {
          method: 'POST',
          headers: {'Content-Type':'application/json'},
          body: JSON.stringify(payload)
        });
        const data = await r.json().catch(()=> ({}));

        if (!r.ok || data?.ok === false) {
          const msg = data?.error || `Sunucu ${r.status} hatasÄ±`;
          alertEl.textContent = `Bir ÅŸeyler ters gitti: ${msg}`;
          alertEl.style.display = 'block';
          stateEl.textContent = '';
          return;
        }

        okEl.textContent = 'RÃ¼yan ulaÅŸtÄ±. E-postanÄ± kontrol edebilirsin. ğŸ‘';
        okEl.style.display = 'block';
        stateEl.textContent = '';
        form.reset();
      } catch (err) {
        alertEl.textContent = `BaÄŸlantÄ± hatasÄ±: ${err?.message || err}`;
        alertEl.style.display = 'block';
        stateEl.textContent = '';
      }
    });
  </script>
</body>
</html>
